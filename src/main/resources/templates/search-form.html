<!DOCTYPE html>
<html xmlns:th = "http://www.thymeleaf.org">
    <body>
        <div th:fragment = "search-form" >
            <form id = "search-from" action="#" th:action="@{/all/search}" th:object="${searchRequest}" method = "get">
                <input id = "search" type = "text" placeholder="search..." th:field="*{content}"/>
                <button type="submit" value="Search" id="bth-search"></button>
            </form>
            <script type="text/javascript" src="../static/js/jquery.1.10.2.min.js" th:src="@{/js/jquery.1.10.2.min.js}" ></script>
            <script type="text/javascript" src="../static/js/jquery.autocomplete.min.js" th:src="@{/js/jquery.autocomplete.min.js}" ></script>
            <script th:inline="javascript">
                $(document).ready(function() {
                        $( "#search" ).autocomplete({
                            serviceUrl: './getAddressObjects',
                            type: "POST",
                            paramName: "searchRequest",
                            dataType: "json",
                            delimiter: ",|-",
                            transformResult: function(response) {
                                console.log(response);
                                return {
                                    suggestions: $.map(response.results, function(item) {
                                        return {
                                            value: item.address,
                                            data: [item.lon, item.lat]
                                        };
                                    })
                                };
                            },
                            onSelect: function (suggestion) {
                                if(map.isExist() && suggestion) {
                                    map.clear();
                                    map.addMarker(suggestion.data[0], suggestion.data[1],
                                        suggestion.value, 15);
                                }
                            },
                            minChars: 3
                        });
                });
            </script>
        </div>
    </body>
</html>